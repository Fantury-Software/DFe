/*

Unimake Software
Exemplo de uso da DLL Unimake.Dfe
Data: 15/02/2022 
Autores: 
- Edson Mundin Ferreira
- Wandrey Mundin Ferreira

*/
Function Main()
   Local aOpcoes, nOpcao
   
   aOpcoes := {}
   AAdd(aOpcoes, "Carregar Certificado A1")
   AAdd(aOpcoes, "Consultar Status NFe")
   AAdd(aOpcoes, "Consultar Situacao NFe")
   AAdd(aOpcoes, "Inutilizar Numero Nfe")
   AAdd(aOpcoes, "Consulta Recibo Nfe")
   AAdd(aOpcoes, "Enviar Nfe - Assincrono")
   AAdd(aOpcoes, "Enviar Evento de Cancelamento da NFe")
   Aadd(aOpcoes, "Teste diversos com certificado digital")
   Aadd(aOpcoes, "Carta de Correcao")
   Aadd(aOpcoes, "Envio da NFSe (GerarNfse)")
   Aadd(aOpcoes, "Enviar NFe - Modo sincrono")
   Aadd(aOpcoes, "Envio MDFe - Assincrono")
   AAdd(aOpcoes, "Enviar NFe - Deserializando o XML")
   AAdd(aOpcoes, "Enviar Evento de Cancelamento da NFe - Desserializando o XML")
   Aadd(aOpcoes, "Gerar XML de distribuicao com um nome diferente do padrao da DLL") 
                              
    
   Do While .T.
      Cls

      @ 1,2 Say "Unimake.Dfe DLL for " + Version()
	  
      nOpcao := Achoice( 3, 2, 20, 80, aOpcoes)

      Cls

      do case
         case LastKey() = 27
              Exit

         case nOpcao = 1
              CarregarCertificadoA1()

         case nOpcao = 2
              ConsultaStatusNfe()

         case nOpcao = 3
              ConsultaSituacaoNfe()

         case nOpcao = 4
              InutilizarNumeroNfe()

         case nOpcao = 5
              ConsultaReciboNfe()

         case nOpcao = 6
              EnviarNfeAssincrono()

         case nOpcao = 7
              CancelarNfe()
			  
         case nOpcao = 8
              TesteDiversoCertificado()

         case nOpcao = 9
              CartaDeCorrecao()
 
         case nOpcao = 10
		      EnviarNfseGerarNfse() 
			  
         case nOpcao = 11
			  EnviarNFeSincrono()

         case nOpcao = 12
			  EnviarMDFeAssincrono()

         Case nOpcao = 13
              EnviarNfeDeserializando()	

         case nOpcao = 14
		      CancelarNFeDesserializando()
		 
		 case nOpcao = 15
		      GerarXmlDistribuicaoNomeDif()		        
	  endcase
   EndDo
Return

       